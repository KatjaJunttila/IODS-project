```{r, include = F}
library(dplyr)
library(tidyr)
library(knitr)
library(ggplot2)
library(corrplot)
library(GGally)
```
```{r}
options(scipen = 999)
```

# Dimensionality reduction techniques

## Loading and inspecting the data

This weeks data deals with human development indicators and the data sets originate from the United Nations Development Programme. You can find more information about the data on their web page: http://hdr.undp.org/en/content/human-development-index-hdi.

Let's do a couple of visualisations of the data.
```{r}
human <- read.csv("data/human.csv", row.names = 1)
ggpairs(human)
```

The above matrix shows scatterplots, distributions, and correlations between variables. The distributions of some variables are quite skewed. Most notably, the gross national income per capita (gni) and maternal mortality (matmor) have mostly low value observations and few high value observations.
```{r}
corrplot(cor(human), method="circle", type = "upper", tl.pos = "d")
```

This correlation plot shows all correlations in a glance. The highest negative correlation is between maternal mortality and life expectancy at birth, while the highest positive correlation is between expected years of schooling and life expectancy at birth.

Here are also summaries of the variables:
```{r}
summary(human)
```

## Principal component analysis

Next, I'll perform the principal component analysis on the unstandardised data.
```{r}
pca_human <- prcomp(human)
summary(pca_human)
```
```{r, fig.height=8, warning=F, fig.cap="Figure 1. A biplot displaying variation captured by the first two principal components. The first component is mostly determined by gross national income per capita (gni) and it explains almost all of the variability"}
biplot(pca_human, choices = 1:2, cex = c(0.8, 1), col = c("grey40", "deeppink2"))
```
 

The summary of the importance of components shows that the first component explains almost all of the variation. From the plot above (Figure 1) we can see that this component is mostly determined by GNI variable. This can be explained by that GNI has much larger range of values than the other variables, as seen in the summary. Therefore, it also has the largest variance. To identify the importance of different variables, we need to standardise the data.
 
```{r}
human_std <- scale(human)
summary(human_std)
```
 Now we can see from the summary, that the data is standardised. All means are now 0.
 
```{r}
pca_human_std <- prcomp(human_std)
summary(pca_human_std)
```
 Now the summary of the importance of components shows that the first component explains about 53.6% of the variation and the second component explains about 16.2%.
 
```{r, fig.height=8, fig.cap="Figure 2. A biplot displaying variation captured by the first two principal components of the principal component analysis performed on the standardised data. The first component is determined by life expectancy, ratio of females to males with at least secondary education, gross national income per capita (gni), expected years of schooling, maternal mortality, and adolescent birth rate. The second component is determined by percetange of female representatives in parliament and ratio of females to males in the labour force." }
s <- summary(pca_human_std)
pca_pr <- round(100*s$importance[2, ], digits = 1)
pc_lab <- paste0(names(pca_pr), " (", pca_pr, "%)")
biplot(pca_human_std, choices = 1:2, cex = c(0.8, 1), col = c("grey40", "deeppink2"), xlab = pc_lab[1], ylab = pc_lab[2])
```
 
Here we can see how variables correlate with principal components and with each other (Figure 2). The angles between the arrows can be interpreted as correlations between the variables and the angles between arrows and principal component axes as correlations between them. The first principal component is defined by two sets of variables that correlate positively with each other but that are negatively correlated with the other set. One set includes life expectancy, ratio of females to males with at least secondary education, gross national income per capita (gni), and expected years of schooling. The other set includes maternal mortality and adolescent birth rate. The first principal component seems to catch variation mostly related to human development factors. The second principal component is defined by percetange of female representatives in parliament and ratio of females to males in the labour force, which correlate positively with each other. The second principal component seems to catch variation related to gender equality factors.


